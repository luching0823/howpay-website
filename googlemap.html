<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>搭配商家結果</title>
    <script type = "text/javascript" src="jquery-3.5.1.js"></script>
    <link rel="stylesheet" href="google.css">
</head>
<body>
    <div id="map"></div>
    <script>
        var marker, map, lat, lng;
        function initMap() {
            navigator.geolocation.getCurrentPosition((position) => {
                console.log(position.coords);
                lat = position.coords.latitude;
                lng = position.coords.longitude;
                var mapcenter = new google.maps.LatLng(lat, lng);
                var options = {
                    zoom: 14,
                    center: mapcenter
                };
                // 初始化地圖
                map = new google.maps.Map(document.getElementById('map'), options);
                marker = new google.maps.Marker({
                    position: mapcenter,
                    map: map,
                    label: 'You'
                });
                var location = [
                    {name:'A', lat:25.0339031, lng:121.5623212},
                    {name:'B', lat:25.063236, lng:121.5503405}
                ];
                for(var i = 0; i < location.length; i ++){
                    var item = location[i];
                    var infoWindow = new google.maps.InfoWindow();
                    var marker = new google.maps.Marker({
                        position: {lat: item.lat, lng: item.lng},
                        map: map,
                        data: 'aaaaa'
                    });
                    marker.addListener('click', function(){
                        infoWindow.setContent(this.data);
                        infoWindow.open(map, this);
                    });
                }
            });
        }
        google.maps.event.addDomListener(window, 'load', initMap);
    //     function initMap() {
    //     var latlng = { lat: 25.046891, lng: 121.516602 }; // 給一個初始位置
    //     var map = new google.maps.Map(document.getElementById('map'), {
    //         zoom: 14, //放大的倍率
    //         center: latlng //初始化的地圖中心位置
    //     });
    //     if (navigator.geolocation) {
    //         navigator.geolocation.getCurrentPosition(function(position) {
    //             var pos = {
    //                 lat: position.coords.latitude,
    //                 lng: position.coords.longitude
    //             };
    //             var marker = new google.maps.Marker({
    //                 position: pos,
    //                 map: map
    //             });
    //             map.setZoom(17);
    //             map.setCenter(pos);
    //         });
    //     } else {
    //         // Browser doesn't support Geolocation
    //         alert("未允許或遭遇錯誤！");
    //     }
    // } 
    //init_end


    </script>
    <script defer src="https://maps.googleapis.com/maps/api/js?key=AIzaSyB9t55gGWuAVhwO16Wbmyrdhl4Wn3AVN6Y&callback=initMap">
    </script>
</body>
</html>